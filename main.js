const localData = [
    {
        "title": "Claimable AI",
        "imgSrc": "assets/medium/claimable-1.png",
        "imgSrcset": "assets/small/claimable-1.png 400w, assets/medium/claimable-1.png 800w, assets/large/claimable-1.png 1200w",
        "sizes": "(min-width: 768px) 33vw, 100vw",
        "imgAlt": "A screenshot of the Claimable AI project interface",
        "href": "projects.html",
        "bgColor": "#DDD6FE",
        "description": "Claimable AI is an innovative platform that leverages artificial intelligence to help users identify and claim financial benefits they may be eligible for. The system uses advanced natural language processing to understand user situations and matches them with applicable programs.",
        "slideshowImages": [
            {"src": "assets/medium/claimable-1.png", "srcset": "assets/small/claimable-1.png 400w, assets/medium/claimable-1.png 800w, assets/large/claimable-1.png 1200w"},
            {"src": "assets/medium/claimable-2.png", "srcset": "assets/small/claimable-2.png 400w, assets/medium/claimable-2.png 800w, assets/large/claimable-2.png 1200w"},
            {"src": "assets/medium/claimable-3.png", "srcset": "assets/small/claimable-3.png 400w, assets/medium/claimable-3.png 800w, assets/large/claimable-3.png 1200w"},
            {"src": "assets/medium/claimable-4.png", "srcset": "assets/small/claimable-4.png 400w, assets/medium/claimable-4.png 800w, assets/large/claimable-4.png 1200w"},
            {"src": "assets/medium/claimable-5.png", "srcset": "assets/small/claimable-5.png 400w, assets/medium/claimable-5.png 800w, assets/large/claimable-5.png 1200w"},
            {"src": "assets/medium/claimable-6.png", "srcset": "assets/small/claimable-6.png 400w, assets/medium/claimable-6.png 800w, assets/large/claimable-6.png 1200w"},
            {"src": "assets/medium/claimable-7.png", "srcset": "assets/small/claimable-7.png 400w, assets/medium/claimable-7.png 800w, assets/large/claimable-7.png 1200w"}
        ]
    },
    {
        "title": "Fulfill AI",
        "imgSrc": "assets/medium/fulfill-1.png",
        "imgSrcset": "assets/small/fulfill-1.png 400w, assets/medium/fulfill-1.png 800w, assets/large/fulfill-1.png 1200w",
        "sizes": "(min-width: 768px) 33vw, 100vw",
        "imgAlt": "Screenshot of Fulfill AI Project",
        "href": "projects.html",
        "bgColor": "#FED7AA",
        "description": "Fulfill AI is a comprehensive tool designed to streamline order fulfillment processes using artificial intelligence. It optimizes inventory management, predicts demand patterns, and automates the fulfillment workflow to reduce errors and improve delivery times.",
        "slideshowImages": [
            {"src": "assets/medium/fulfill-1.png", "srcset": "assets/small/fulfill-1.png 400w, assets/medium/fulfill-1.png 800w, assets/large/fulfill-1.png 1200w"},
            {"src": "assets/medium/fulfill-2.png", "srcset": "assets/small/fulfill-2.png 400w, assets/medium/fulfill-2.png 800w, assets/large/fulfill-2.png 1200w"},
            {"src": "assets/medium/fulfill-3.png", "srcset": "assets/small/fulfill-3.png 400w, assets/medium/fulfill-3.png 800w, assets/large/fulfill-3.png 1200w"}
        ]
    },
    {
        "title": "Ecommerce Web Scraper",
        "imgSrc": "assets/medium/ecommerce-1.png",
        "imgSrcset": "assets/small/ecommerce-1.png 400w, assets/medium/ecommerce-1.png 800w, assets/large/ecommerce-1.png 1200w",
        "sizes": "(min-width: 768px) 33vw, 100vw",
        "imgAlt": "Screenshot of Ecommerce Scraper Project",
        "href": "projects.html",
        "bgColor": "#FBCFE8",
        "description": "The Ecommerce Web Scraper is a powerful tool built to extract product data from multiple online retailers. It collects pricing information, product details, and availability data in real-time, enabling competitive analysis and market research.",
        "slideshowImages": [
            {"src": "assets/medium/ecommerce-1.png", "srcset": "assets/small/ecommerce-1.png 400w, assets/medium/ecommerce-1.png 800w, assets/large/ecommerce-1.png 1200w"}
        ]
    },
    {
        "title": "Non Profit CRM",
        "imgSrc": "assets/medium/fundraising-1.png",
        "imgSrcset": "assets/small/fundraising-1.png 400w, assets/medium/fundraising-1.png 800w, assets/large/fundraising-1.png 1200w",
        "sizes": "(min-width: 768px) 33vw, 100vw",
        "imgAlt": "Screenshot of Fundraising CRM",
        "href": "projects.html",
        "bgColor": "#BFDBFE",
        "description": "The Non Profit CRM streamlines donor management and fundraising campaigns for charitable organizations. It tracks donor interactions, manages gift history, and automates engagement workflows to maximize fundraising efficiency.",
        "slideshowImages": [
            {"src": "assets/medium/fundraising-1.png", "srcset": "assets/small/fundraising-1.png 400w, assets/medium/fundraising-1.png 800w, assets/large/fundraising-1.png 1200w"},
            {"src": "assets/medium/fundraising-2.png", "srcset": "assets/small/fundraising-2.png 400w, assets/medium/fundraising-2.png 800w, assets/large/fundraising-2.png 1200w"},
            {"src": "assets/medium/fundraising-3.png", "srcset": "assets/small/fundraising-3.png 400w, assets/medium/fundraising-3.png 800w, assets/large/fundraising-3.png 1200w"},
            {"src": "assets/medium/fundraising-4.png", "srcset": "assets/small/fundraising-4.png 400w, assets/medium/fundraising-4.png 800w, assets/large/fundraising-4.png 1200w"},
            {"src": "assets/medium/fundraising-5.png", "srcset": "assets/small/fundraising-5.png 400w, assets/medium/fundraising-5.png 800w, assets/large/fundraising-5.png 1200w"},
            {"src": "assets/medium/fundraising-6.png", "srcset": "assets/small/fundraising-6.png 400w, assets/medium/fundraising-6.png 800w, assets/large/fundraising-6.png 1200w"}
        ]
    },
    {
        "title": "Mash",
        "imgSrc": "assets/medium/mash-1.png",
        "imgSrcset": "assets/small/mash-1.png 400w, assets/medium/mash-1.png 800w, assets/large/mash-1.png 1200w",
        "sizes": "(min-width: 768px) 33vw, 100vw",
        "imgAlt": "Screenshot of Mash Project",
        "href": "projects.html",
        "bgColor": "#C7D2FE",
        "description": "Mash is a collaborative music creation platform that enables musicians to work together in real-time. It provides tools for audio mixing, beat creation, and seamless collaboration across different locations.",
        "slideshowImages": [
            {"src": "assets/medium/mash-1.png", "srcset": "assets/small/mash-1.png 400w, assets/medium/mash-1.png 800w, assets/large/mash-1.png 1200w"},
            {"src": "assets/medium/mash-2.png", "srcset": "assets/small/mash-2.png 400w, assets/medium/mash-2.png 800w, assets/large/mash-2.png 1200w"},
            {"src": "assets/medium/mash-3.png", "srcset": "assets/small/mash-3.png 400w, assets/medium/mash-3.png 800w, assets/large/mash-3.png 1200w"},
            {"src": "assets/medium/mash-4.png", "srcset": "assets/small/mash-4.png 400w, assets/medium/mash-4.png 800w, assets/large/mash-4.png 1200w"}
        ]
    },
    {
        "title": "ForScale",
        "imgSrc": "assets/medium/forscale-1.jpg",
        "imgSrcset": "assets/small/forscale-1.jpg 400w, assets/medium/forscale-1.jpg 800w, assets/large/forscale-1.jpg 1200w",
        "sizes": "(min-width: 768px) 33vw, 100vw",
        "imgAlt": "Screenshot of ForScale Project",
        "href": "projects.html",
        "bgColor": "#FEF3C7",
        "description": "ForScale is a scalability testing and monitoring tool designed for modern cloud infrastructure. It helps developers identify performance bottlenecks and optimize their applications for high-traffic scenarios.",
        "slideshowImages": [
            {"src": "assets/medium/forscale-1.jpg", "srcset": "assets/small/forscale-1.jpg 400w, assets/medium/forscale-1.jpg 800w, assets/large/forscale-1.jpg 1200w"},
            {"src": "assets/medium/forscale-2.jpg", "srcset": "assets/small/forscale-2.jpg 400w, assets/medium/forscale-2.jpg 800w, assets/large/forscale-2.jpg 1200w"}
        ]
    }
];

const cardContainer = document.querySelector('.project-card-container');
const loadLocalBtn = document.getElementById('load-local');
const loadRemoteBtn = document.getElementById('load-remote');

const BIN_ID = '692fe72943b1c97be9d46e7a'; 
const API_KEY = '$2a$10$eerLTsJLDYhO6IlxwvwnUOQD6veIe/Jzbu9zyYGiSwKiU.Q6Cuyvi '; 

function renderCards(projects) {
    cardContainer.innerHTML = '';

    projects.forEach(project => {
        const card = document.createElement('project-card');

        card.setAttribute('title', project.title);
        card.setAttribute('img-src', project.imgSrc);
        card.setAttribute('img-srcset', project.imgSrcset);
        card.setAttribute('sizes', project.sizes);
        card.setAttribute('img-alt', project.imgAlt);
        // Use `github` attribute for the repository link (falls back to '#')
        card.setAttribute('github', project.github || '#');
        card.setAttribute('bg-color', project.bgColor);
        // Set the description attribute
        card.setAttribute('description', project.description || '');
        // Set the slideshow images if available
        if (project.slideshowImages && project.slideshowImages.length > 0) {
            card.setAttribute('slideshow-images', JSON.stringify(project.slideshowImages));
        }

        cardContainer.appendChild(card);
    });
}

function loadLocal() {
    const storedData = localStorage.getItem('myLocalProjects');
    
    if (storedData) {
        const projects = JSON.parse(storedData);
        console.log('Loaded from LocalStorage:', projects);
        renderCards(projects);
    } else {
        console.error('No local data found!');
    }
}

async function loadRemote() {
    try {
        cardContainer.innerHTML = `
            <div style="display: flex; justify-content: center; align-items: center; min-height: 300px; width: 100%; grid-column: 1 / -1;">
                <div style="text-align: center;">
                    <div style="
                        border: 4px solid var(--border-color);
                        border-top: 4px solid var(--primary-color);
                        border-radius: 50%;
                        width: 50px;
                        height: 50px;
                        animation: spin 1s linear infinite;
                        margin: 0 auto 1rem;
                    "></div>
                    <p style="color: var(--text-primary); font-size: 1.4rem;">Loading projects...</p>
                </div>
            </div>
        `;

        // Add animation if not already in styles
        if (!document.querySelector('style[data-spinner]')) {
            const style = document.createElement('style');
            style.setAttribute('data-spinner', 'true');
            style.textContent = `
                @keyframes spin {
                    to { transform: rotate(360deg); }
                }
            `;
            document.head.appendChild(style);
        }

        const response = await fetch(`https://api.jsonbin.io/v3/b/${BIN_ID}`, {
            headers: {
                'X-Master-Key': API_KEY
            }
        });

        if (!response.ok) {
            throw new Error(`HTTP error! status: ${response.status}`);
        }

        const data = await response.json();
        
        const projects = data.record; 
        
        console.log('Loaded from Remote:', projects);
        renderCards(projects);

    } catch (error) {
        console.error('Error fetching remote data:', error);
        cardContainer.innerHTML = '<p style="text-align:center; color:red;">Error loading data.</p>';
    }
}

document.addEventListener('DOMContentLoaded', () => {
    // Always update localStorage with the latest localData
    localStorage.setItem('myLocalProjects', JSON.stringify(localData));

    loadLocalBtn.addEventListener('click', loadLocal);
    loadRemoteBtn.addEventListener('click', loadRemote);
});
